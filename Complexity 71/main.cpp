#include "SequenceGenerator.h"
#include <iostream>
#include <vector>
#include "ComplexityToDebruijn.h"
#include <fstream>

using namespace std;


int main(){
    cout << "Starting..." << endl;
    int order = 6;
    for(int c = 41; c < 48; c++){
        std::ofstream out("order_"+ to_string(order)+"_complexity_"+ to_string(c) +"_new.txt");
        std::streambuf *coutbuf = std::cout.rdbuf(); //save old buf
        std::cout.rdbuf(out.rdbuf()); //redirect std::cout to out.txt!
        time_t start, end;
        time(&start);
        int complexity = c;
        ComplexityToDebruijn C(complexity,order);
        SequenceGenerator seq(complexity - pow(2,order - 1));
        auto s = seq.getSequences();
        /*TODO:
        * automate the complexity choosing
        * remove rotations from sub sequences
        */
        s = C.removeRotations(s);
        ll amount_of_sequences_overall = 0;
        cout << "For order "<< order << " complexity "<< complexity<< ":" << endl;
        for (const auto& i : s) {
            cout <<"Debruijn Sequences generated by the sub sequence "<< i << " : " << endl;
            string x = i+i;
            if (i.length() == 8){
                x += i+i;
            }
            int seq_num = C.fromSubseqToDebruijn(x);
            amount_of_sequences_overall+=seq_num;
            cout << "the number of Debruijn sequences: " << seq_num << endl << endl;
        }
        cout << "number of subsequences with complexity " << complexity - pow(2,order - 1)<< " is: " << seq.getNumOfSeq() << endl;

        time(&end);

        cout << "overall execution time is " << end - start << " seconds" << endl;
        std::cout.rdbuf(coutbuf); //reset to standard output again
        cout << "amount_of_sequences_overall: " << amount_of_sequences_overall << endl;
        cout << "Done with "  << complexity << endl;
    }
    cout << "Done with all complexities!!!" << endl;
}